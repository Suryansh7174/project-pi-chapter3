const RAW_SUMS = [2, 5, 12, 11, 12];   // raw vertical & crosswise results
const CARRIES = [0, 0, 1, 1, 1];       // carry passed forward
let currentStep = 0;

function checkStep() {
    const input = Number(document.getElementById(`ans-${currentStep}`).value);
    const message = document.getElementById("step-message");

    let total = RAW_SUMS[currentStep] + (currentStep > 0 ? CARRIES[currentStep - 1] : 0);
    let expected = (currentStep === 4) ? total : total % 10;

    if (input === expected) {
        message.textContent = `Step ${currentStep + 1} correct.`;
        message.className = "log-message success-log";

        document.querySelectorAll(".step")[currentStep].classList.remove("active");
        currentStep++;

        if (currentStep < 5) {
            document.querySelectorAll(".step")[currentStep].classList.add("active");
            document.getElementById("check-btn").textContent = `LOCK IN STEP ${currentStep + 1}`;
        } else {
            revealFinalLock();
        }
    } else {
        message.textContent = "Incorrect. Recheck vertical and crosswise logic.";
        message.className = "log-message alert-log";
    }
}

function revealFinalLock() {
    document.getElementById("sutra-grid").classList.add("hidden");
    document.getElementById("final-lock").classList.remove("hidden");
}

const LOCK_CODE = "225";

function moveFocus(current, next) {
    if (current.value.length === 1) {
        document.getElementById(next)?.focus();
    }
}

function checkLock() {
    const code =
        document.getElementById("code-1").value +
        document.getElementById("code-2").value +
        document.getElementById("code-3").value;

    const msg = document.getElementById("lock-message");

    if (code === LOCK_CODE) {
        msg.textContent = "EXIT GRANTED.";
        msg.className = "log-message success-log";
        document.getElementById("final-lock").classList.add("hidden");
        document.getElementById("success-tease").classList.remove("hidden");
    } else {
        msg.textContent = "INCORRECT CORE. TRY AGAIN.";
        msg.className = "log-message alert-log";
    }
}
